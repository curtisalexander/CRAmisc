<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Update a readr column specification. — spec_update • CRAmisc</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">CRAmisc</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/curtisalexander/CRAmisc">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Update a readr column specification.</h1>
    </div>

    
    <p>Given a <a href='http://www.rdocumentation.org/packages/readr/topics/cols'>cols</a> specification, update the specification in place
by explicitly declaring the appropriate type in a dataframe.</p>
    

    <pre><span class='fu'>spec_update</span>(<span class='no'>col_spec</span>, <span class='no'>col_spec_df</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>col_spec</dt>
      <dd>A <a href='http://www.rdocumentation.org/packages/readr/topics/cols'>cols</a> specification.  Most commonly produced
as part of a call to <a href='http://www.rdocumentation.org/packages/readr/topics/read_delim'>read_csv</a>.</dd>
      <dt>col_spec_df</dt>
      <dd>A dataframe containing the column name and type to update
within the specification.  The expectation is that <code>col_spec_df</code> has
columns named <code>col_name</code> and <code>col_type</code>.  If <code>col_spec_df</code>
has columns named differently, this is easy to convert using
<a href='http://www.rdocumentation.org/packages/dplyr/topics/select'>rename</a>.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A copy of the original specification with updated column types.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is of value when importing an extremely wide dataframe with many
columns.  It may not make sense to explicitly declare the type of every
column by hand.  Nor should one have to copy/paste an exisiting column
specification into a text editor in order to update the specification.</p>
    <p>A final use case is when problems occur and a <a href='http://www.rdocumentation.org/packages/readr/topics/problems'>problems</a> tibble
is created.  The tibble can be the starting point to decide upon the columns
that require updating.</p>
    <p><code>spec_update</code> is a closure that contains two parts.
<ul>
<li> An inner function, <code>update_</code>, that updates the specification by
  setting the <code>class</code> attribute for the given column.
  </li>
<li> The enclosing environment that contains the specification to be
  updated and contains a call to <a href='http://www.rdocumentation.org/packages/purrr/topics/map2'>pmap</a> to drive
  iteration.
</li>
</ul></p>
    

    <h2 class="hasAnchor" id="examples">
      <a class="anchor" href="#examples"></a>
      Examples
    </h2>
    <pre class="examples"><div class='input'><span class='no'>test_df</span> <span class='kw'>&lt;-</span> <span class='kw'>readr</span><span class='kw'>::</span><span class='fu'>read_csv</span>(<span class='st'>"a,b,c\n1,2,3\n4,5,6"</span>)
<span class='no'>test_spec</span> <span class='kw'>&lt;-</span> <span class='kw'>readr</span><span class='kw'>::</span><span class='fu'>spec</span>(<span class='no'>test_df</span>)

<span class='co'>## returns</span>
<span class='co'>##   a = col_integer()</span>
<span class='co'>##   b = col_integer()</span>
<span class='co'>##   c = col_integer()</span>

<span class='co'>## update columns a and b to be doubles instead of integers</span>
<span class='no'>col_spec_df</span> <span class='kw'>&lt;-</span> <span class='kw'>tibble</span><span class='kw'>::</span><span class='fu'>tribble</span>(
  ~<span class='no'>col_name</span>, ~<span class='no'>col_type</span>,
  <span class='st'>"a"</span>, <span class='st'>"double"</span>,
  <span class='st'>"b"</span>, <span class='st'>"double"</span>
)

<span class='co'>## update the specification</span>
<span class='no'>test_spec_updated</span> <span class='kw'>&lt;-</span> <span class='fu'>spec_update</span>(<span class='no'>test_spec</span>, <span class='no'>col_spec_df</span>)

<span class='co'>## re-read with new column spec</span>
<span class='no'>test_updated</span> <span class='kw'>&lt;-</span> <span class='kw'>readr</span><span class='kw'>::</span><span class='fu'>read_csv</span>(<span class='st'>"a,b,c\n1,2,3\n4,5,6"</span>,
                                <span class='kw'>col_types</span> <span class='kw'>=</span> <span class='no'>test_spec_updated</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Curtis Alexander.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
